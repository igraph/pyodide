From cdeac3972201794e898645dd61d47da203ee498e Mon Sep 17 00:00:00 2001
From: Tamas Nepusz <ntamas@gmail.com>
Date: Tue, 11 Jul 2023 13:01:59 +0200
Subject: [PATCH 2/3] fix: wasm32 size_t is 32-bit so we need to fix the
 definition of RNG_MAX

---
 src/_igraph/random.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/_igraph/random.c b/src/_igraph/random.c
index b059042d..61b67b04 100644
--- a/src/_igraph/random.c
+++ b/src/_igraph/random.c
@@ -44,7 +44,12 @@ typedef struct {
 } igraph_i_rng_Python_state_t;
 
 #define RNG_BITS 32
-#define RNG_MAX ((((size_t) 1) << RNG_BITS) - 1)
+#ifdef __wasm32__
+  /* size_t is 32-bit on wasm32 so we cannot use the shift trick */
+  #define RNG_MAX 0xFFFFFFFF
+#else
+  #define RNG_MAX ((((size_t) 1) << RNG_BITS) - 1)
+#endif
 
 static igraph_i_rng_Python_state_t igraph_rng_Python_state = {0};
 static igraph_rng_t igraph_rng_Python = {
-- 
2.41.0

